logs/TEMPO/loar_revin_100_percent_1_prompt_equal_1/ettm2_pmt1_no_pool_TEMPO_3/test_104_24_lr0.001.log
Namespace(model_id='illness_TEMPO_3_prompt_learn_104_24_100', checkpoints='./lora_revin_6domain_checkpoints_1/', task_name='long_term_forecast', prompt=1, num_nodes=1, seq_len=104, pred_len=24, label_len=18, decay_fac=0.5, learning_rate=0.001, batch_size=256, num_workers=0, train_epochs=100, lradj='type3', patience=5, gpt_layers=3, is_gpt=1, e_layers=3, d_model=768, n_heads=4, d_ff=768, dropout=0.3, enc_in=1, c_out=1, patch_size=16, kernel_size=25, loss_func='mse', pretrain=1, freeze=1, model='TEMPO', stride=8, max_len=-1, hid_dim=16, tmax=20, itr=1, cos=1, equal=1, pool=False, no_stl_loss=False, stl_weight=0.001, config_path='./configs/multiple_datasets.yml', datasets='ILI', target_data='ILI', use_token=0, electri_multiplier=1, traffic_multiplier=1, embed='timeF', percent_aug=-100, aug='ili-clo-0_256_gen_100repeat.npy', aug_only=0)
['ILI']
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (549) from 549
549 new ds
256 146
decomposing time-series...
done!
train 1098
Data aug...
0 146
val 74
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (549) from 549
549 new ds
256 146
decomposing time-series...
done!
train 1098
Data aug...
0 146
test 170
trainable params: 154368 || all params: 60796416 || trainable%: 0.25
Epoch: 1 cost time: 0.6027872562408447
Epoch: 1, Steps: 4 | Train Loss: 1.3868271 Vali Loss: 0.9634054
lr = 0.0009938442
Validation loss decreased (inf --> 0.963405).  Saving model ...
Epoch: 2 cost time: 0.34555649757385254
Epoch: 2, Steps: 4 | Train Loss: 0.8328734 Vali Loss: 0.5117408
lr = 0.0009755285
Validation loss decreased (0.963405 --> 0.511741).  Saving model ...
Epoch: 3 cost time: 0.3519620895385742
Epoch: 3, Steps: 4 | Train Loss: 0.5642494 Vali Loss: 0.2030572
lr = 0.0009455038
Validation loss decreased (0.511741 --> 0.203057).  Saving model ...
Epoch: 4 cost time: 0.370835542678833
Epoch: 4, Steps: 4 | Train Loss: 0.4709003 Vali Loss: 0.1292846
lr = 0.0009045095
Validation loss decreased (0.203057 --> 0.129285).  Saving model ...
Epoch: 5 cost time: 0.37221598625183105
Epoch: 5, Steps: 4 | Train Loss: 0.3310249 Vali Loss: 0.1885692
lr = 0.0008535549
EarlyStopping counter: 1 out of 5
Epoch: 6 cost time: 0.3766615390777588
Epoch: 6, Steps: 4 | Train Loss: 0.2596523 Vali Loss: 0.1421555
lr = 0.0007938947
EarlyStopping counter: 2 out of 5
Epoch: 7 cost time: 0.38510608673095703
Epoch: 7, Steps: 4 | Train Loss: 0.2604512 Vali Loss: 0.0995675
lr = 0.0007269980
Validation loss decreased (0.129285 --> 0.099568).  Saving model ...
Epoch: 8 cost time: 0.39990830421447754
Epoch: 8, Steps: 4 | Train Loss: 0.2212456 Vali Loss: 0.1038047
lr = 0.0006545120
EarlyStopping counter: 1 out of 5
Epoch: 9 cost time: 0.37815213203430176
Epoch: 9, Steps: 4 | Train Loss: 0.2005213 Vali Loss: 0.0959677
lr = 0.0005782215
Validation loss decreased (0.099568 --> 0.095968).  Saving model ...
Epoch: 10 cost time: 0.37157535552978516
Epoch: 10, Steps: 4 | Train Loss: 0.1860958 Vali Loss: 0.0810450
lr = 0.0005000050
Validation loss decreased (0.095968 --> 0.081045).  Saving model ...
Epoch: 11 cost time: 0.3619520664215088
Epoch: 11, Steps: 4 | Train Loss: 0.1896783 Vali Loss: 0.0866437
lr = 0.0004217885
EarlyStopping counter: 1 out of 5
Epoch: 12 cost time: 0.37986040115356445
Epoch: 12, Steps: 4 | Train Loss: 0.1714098 Vali Loss: 0.0774367
lr = 0.0003454980
Validation loss decreased (0.081045 --> 0.077437).  Saving model ...
Epoch: 13 cost time: 0.3907637596130371
Epoch: 13, Steps: 4 | Train Loss: 0.1656182 Vali Loss: 0.0774193
lr = 0.0002730120
Validation loss decreased (0.077437 --> 0.077419).  Saving model ...
Epoch: 14 cost time: 0.3913750648498535
Epoch: 14, Steps: 4 | Train Loss: 0.1759194 Vali Loss: 0.0790556
lr = 0.0002061153
EarlyStopping counter: 1 out of 5
Epoch: 15 cost time: 0.38559746742248535
Epoch: 15, Steps: 4 | Train Loss: 0.1482123 Vali Loss: 0.0691723
lr = 0.0001464551
Validation loss decreased (0.077419 --> 0.069172).  Saving model ...
Epoch: 16 cost time: 0.37595558166503906
Epoch: 16, Steps: 4 | Train Loss: 0.1630946 Vali Loss: 0.0811014
lr = 0.0000955005
EarlyStopping counter: 1 out of 5
Epoch: 17 cost time: 0.36316776275634766
Epoch: 17, Steps: 4 | Train Loss: 0.1577816 Vali Loss: 0.0765382
lr = 0.0000545062
EarlyStopping counter: 2 out of 5
Epoch: 18 cost time: 0.35529541969299316
Epoch: 18, Steps: 4 | Train Loss: 0.1465285 Vali Loss: 0.0717277
lr = 0.0000244815
EarlyStopping counter: 3 out of 5
Epoch: 19 cost time: 0.37139081954956055
Epoch: 19, Steps: 4 | Train Loss: 0.1710741 Vali Loss: 0.0724322
lr = 0.0000061658
EarlyStopping counter: 4 out of 5
Epoch: 20 cost time: 0.3303802013397217
Epoch: 20, Steps: 4 | Train Loss: 0.1607384 Vali Loss: 0.0759533
lr = 0.0000000100
EarlyStopping counter: 5 out of 5
Early stopping
------------------------------------
Average MAE: 0.755859375
Average MSE: 0.79345703125
test on the ILI dataset: mse:0.79345703125 mae:0.755859375
mse_mean = 0.7935, mse_std = 0.0000
mae_mean = 0.7559, mae_std = 0.0000
logs/TEMPO/loar_revin_100_percent_1_prompt_equal_1/ettm2_pmt1_no_pool_TEMPO_3/test_104_36_lr0.001.log
Namespace(model_id='illness_TEMPO_3_prompt_learn_104_36_100', checkpoints='./lora_revin_6domain_checkpoints_1/', task_name='long_term_forecast', prompt=1, num_nodes=1, seq_len=104, pred_len=36, label_len=18, decay_fac=0.5, learning_rate=0.001, batch_size=256, num_workers=0, train_epochs=100, lradj='type3', patience=5, gpt_layers=3, is_gpt=1, e_layers=3, d_model=768, n_heads=4, d_ff=768, dropout=0.3, enc_in=1, c_out=1, patch_size=16, kernel_size=25, loss_func='mse', pretrain=1, freeze=1, model='TEMPO', stride=8, max_len=-1, hid_dim=16, tmax=20, itr=1, cos=1, equal=1, pool=False, no_stl_loss=False, stl_weight=0.001, config_path='./configs/multiple_datasets.yml', datasets='ILI', target_data='ILI', use_token=0, electri_multiplier=1, traffic_multiplier=1, embed='timeF', percent_aug=-100, aug='ili-clo-0_256_gen_100repeat.npy', aug_only=0)
['ILI']
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (537) from 537
537 new ds
256 158
decomposing time-series...
done!
train 1074
Data aug...
0 158
val 62
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (537) from 537
537 new ds
256 158
decomposing time-series...
done!
train 1074
Data aug...
0 158
test 158
trainable params: 154368 || all params: 60796416 || trainable%: 0.25
Epoch: 1 cost time: 0.7318136692047119
Epoch: 1, Steps: 4 | Train Loss: 1.7736624 Vali Loss: 0.7610902
lr = 0.0009938442
Validation loss decreased (inf --> 0.761090).  Saving model ...
Epoch: 2 cost time: 0.3513157367706299
Epoch: 2, Steps: 4 | Train Loss: 0.7661619 Vali Loss: 0.3277362
lr = 0.0009755285
Validation loss decreased (0.761090 --> 0.327736).  Saving model ...
Epoch: 3 cost time: 0.3614060878753662
Epoch: 3, Steps: 4 | Train Loss: 0.5647040 Vali Loss: 0.1660122
lr = 0.0009455038
Validation loss decreased (0.327736 --> 0.166012).  Saving model ...
Epoch: 4 cost time: 0.35311102867126465
Epoch: 4, Steps: 4 | Train Loss: 0.3600891 Vali Loss: 0.1699081
lr = 0.0009045095
EarlyStopping counter: 1 out of 5
Epoch: 5 cost time: 0.35059499740600586
Epoch: 5, Steps: 4 | Train Loss: 0.2935722 Vali Loss: 0.1419466
lr = 0.0008535549
Validation loss decreased (0.166012 --> 0.141947).  Saving model ...
Epoch: 6 cost time: 0.37581825256347656
Epoch: 6, Steps: 4 | Train Loss: 0.2546045 Vali Loss: 0.1135692
lr = 0.0007938947
Validation loss decreased (0.141947 --> 0.113569).  Saving model ...
Epoch: 7 cost time: 0.36591172218322754
Epoch: 7, Steps: 4 | Train Loss: 0.2274403 Vali Loss: 0.1020946
lr = 0.0007269980
Validation loss decreased (0.113569 --> 0.102095).  Saving model ...
Epoch: 8 cost time: 0.37630200386047363
Epoch: 8, Steps: 4 | Train Loss: 0.2140584 Vali Loss: 0.0923006
lr = 0.0006545120
Validation loss decreased (0.102095 --> 0.092301).  Saving model ...
Epoch: 9 cost time: 0.3745732307434082
Epoch: 9, Steps: 4 | Train Loss: 0.2045465 Vali Loss: 0.0926365
lr = 0.0005782215
EarlyStopping counter: 1 out of 5
Epoch: 10 cost time: 0.35955119132995605
Epoch: 10, Steps: 4 | Train Loss: 0.1873051 Vali Loss: 0.0859392
lr = 0.0005000050
Validation loss decreased (0.092301 --> 0.085939).  Saving model ...
Epoch: 11 cost time: 0.3690943717956543
Epoch: 11, Steps: 4 | Train Loss: 0.1786934 Vali Loss: 0.0859050
lr = 0.0004217885
Validation loss decreased (0.085939 --> 0.085905).  Saving model ...
Epoch: 12 cost time: 0.38036203384399414
Epoch: 12, Steps: 4 | Train Loss: 0.1758359 Vali Loss: 0.0835296
lr = 0.0003454980
Validation loss decreased (0.085905 --> 0.083530).  Saving model ...
Epoch: 13 cost time: 0.3770720958709717
Epoch: 13, Steps: 4 | Train Loss: 0.1741691 Vali Loss: 0.0787193
lr = 0.0002730120
Validation loss decreased (0.083530 --> 0.078719).  Saving model ...
Epoch: 14 cost time: 0.37837982177734375
Epoch: 14, Steps: 4 | Train Loss: 0.1679268 Vali Loss: 0.0758305
lr = 0.0002061153
Validation loss decreased (0.078719 --> 0.075831).  Saving model ...
Epoch: 15 cost time: 0.3907303810119629
Epoch: 15, Steps: 4 | Train Loss: 0.1695520 Vali Loss: 0.0796973
lr = 0.0001464551
EarlyStopping counter: 1 out of 5
Epoch: 16 cost time: 0.3932316303253174
Epoch: 16, Steps: 4 | Train Loss: 0.1493695 Vali Loss: 0.0794614
lr = 0.0000955005
EarlyStopping counter: 2 out of 5
Epoch: 17 cost time: 0.37457799911499023
Epoch: 17, Steps: 4 | Train Loss: 0.1603941 Vali Loss: 0.0778192
lr = 0.0000545062
EarlyStopping counter: 3 out of 5
Epoch: 18 cost time: 0.3786318302154541
Epoch: 18, Steps: 4 | Train Loss: 0.1620487 Vali Loss: 0.0738413
lr = 0.0000244815
Validation loss decreased (0.075831 --> 0.073841).  Saving model ...
Epoch: 19 cost time: 0.37015819549560547
Epoch: 19, Steps: 4 | Train Loss: 0.1578640 Vali Loss: 0.0759474
lr = 0.0000061658
EarlyStopping counter: 1 out of 5
Epoch: 20 cost time: 0.37862229347229004
Epoch: 20, Steps: 4 | Train Loss: 0.1671688 Vali Loss: 0.0735309
lr = 0.0000000100
Validation loss decreased (0.073841 --> 0.073531).  Saving model ...
Epoch: 21 cost time: 0.37360525131225586
Epoch: 21, Steps: 4 | Train Loss: 0.1761844 Vali Loss: 0.0718677
lr = 0.0000061658
Validation loss decreased (0.073531 --> 0.071868).  Saving model ...
Epoch: 22 cost time: 0.38773202896118164
Epoch: 22, Steps: 4 | Train Loss: 0.1654089 Vali Loss: 0.0748509
lr = 0.0000244815
EarlyStopping counter: 1 out of 5
Epoch: 23 cost time: 0.374417781829834
Epoch: 23, Steps: 4 | Train Loss: 0.1567226 Vali Loss: 0.0737607
lr = 0.0000545062
EarlyStopping counter: 2 out of 5
Epoch: 24 cost time: 0.3558177947998047
Epoch: 24, Steps: 4 | Train Loss: 0.1602062 Vali Loss: 0.0811881
lr = 0.0000955005
EarlyStopping counter: 3 out of 5
Epoch: 25 cost time: 0.3619985580444336
Epoch: 25, Steps: 4 | Train Loss: 0.1773818 Vali Loss: 0.0757271
lr = 0.0001464551
EarlyStopping counter: 4 out of 5
Epoch: 26 cost time: 0.3594498634338379
Epoch: 26, Steps: 4 | Train Loss: 0.1559022 Vali Loss: 0.0779633
lr = 0.0002061153
EarlyStopping counter: 5 out of 5
Early stopping
------------------------------------
Average MAE: 0.84716796875
Average MSE: 0.92626953125
test on the ILI dataset: mse:0.92626953125 mae:0.84716796875
mse_mean = 0.9263, mse_std = 0.0000
mae_mean = 0.8472, mae_std = 0.0000
logs/TEMPO/loar_revin_100_percent_1_prompt_equal_1/ettm2_pmt1_no_pool_TEMPO_3/test_104_48_lr0.001.log
Namespace(model_id='illness_TEMPO_3_prompt_learn_104_48_100', checkpoints='./lora_revin_6domain_checkpoints_1/', task_name='long_term_forecast', prompt=1, num_nodes=1, seq_len=104, pred_len=48, label_len=18, decay_fac=0.5, learning_rate=0.001, batch_size=256, num_workers=0, train_epochs=100, lradj='type3', patience=5, gpt_layers=3, is_gpt=1, e_layers=3, d_model=768, n_heads=4, d_ff=768, dropout=0.3, enc_in=1, c_out=1, patch_size=16, kernel_size=25, loss_func='mse', pretrain=1, freeze=1, model='TEMPO', stride=8, max_len=-1, hid_dim=16, tmax=20, itr=1, cos=1, equal=1, pool=False, no_stl_loss=False, stl_weight=0.001, config_path='./configs/multiple_datasets.yml', datasets='ILI', target_data='ILI', use_token=0, electri_multiplier=1, traffic_multiplier=1, embed='timeF', percent_aug=-100, aug='ili-clo-0_256_gen_100repeat.npy', aug_only=0)
['ILI']
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (525) from 525
525 new ds
256 170
decomposing time-series...
done!
train 1050
Data aug...
0 170
val 50
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (525) from 525
525 new ds
256 170
decomposing time-series...
done!
train 1050
Data aug...
0 170
test 146
trainable params: 154368 || all params: 60796416 || trainable%: 0.25
Epoch: 1 cost time: 0.6155898571014404
Epoch: 1, Steps: 4 | Train Loss: 1.4019648 Vali Loss: 0.7321474
lr = 0.0009938442
Validation loss decreased (inf --> 0.732147).  Saving model ...
Epoch: 2 cost time: 0.3637559413909912
Epoch: 2, Steps: 4 | Train Loss: 0.7732900 Vali Loss: 0.3839492
lr = 0.0009755285
Validation loss decreased (0.732147 --> 0.383949).  Saving model ...
Epoch: 3 cost time: 0.34484338760375977
Epoch: 3, Steps: 4 | Train Loss: 0.4815974 Vali Loss: 0.1974021
lr = 0.0009455038
Validation loss decreased (0.383949 --> 0.197402).  Saving model ...
Epoch: 4 cost time: 0.36942362785339355
Epoch: 4, Steps: 4 | Train Loss: 0.3726036 Vali Loss: 0.1295798
lr = 0.0009045095
Validation loss decreased (0.197402 --> 0.129580).  Saving model ...
Epoch: 5 cost time: 0.3566763401031494
Epoch: 5, Steps: 4 | Train Loss: 0.2693531 Vali Loss: 0.1362958
lr = 0.0008535549
EarlyStopping counter: 1 out of 5
Epoch: 6 cost time: 0.34935641288757324
Epoch: 6, Steps: 4 | Train Loss: 0.2408862 Vali Loss: 0.1149628
lr = 0.0007938947
Validation loss decreased (0.129580 --> 0.114963).  Saving model ...
Epoch: 7 cost time: 0.35586023330688477
Epoch: 7, Steps: 4 | Train Loss: 0.2237320 Vali Loss: 0.1003414
lr = 0.0007269980
Validation loss decreased (0.114963 --> 0.100341).  Saving model ...
Epoch: 8 cost time: 0.3188316822052002
Epoch: 8, Steps: 4 | Train Loss: 0.2180330 Vali Loss: 0.1059649
lr = 0.0006545120
EarlyStopping counter: 1 out of 5
Epoch: 9 cost time: 0.3189678192138672
Epoch: 9, Steps: 4 | Train Loss: 0.1913341 Vali Loss: 0.0970789
lr = 0.0005782215
Validation loss decreased (0.100341 --> 0.097079).  Saving model ...
Epoch: 10 cost time: 0.37026190757751465
Epoch: 10, Steps: 4 | Train Loss: 0.1848251 Vali Loss: 0.0924161
lr = 0.0005000050
Validation loss decreased (0.097079 --> 0.092416).  Saving model ...
Epoch: 11 cost time: 0.3711268901824951
Epoch: 11, Steps: 4 | Train Loss: 0.1795437 Vali Loss: 0.0903300
lr = 0.0004217885
Validation loss decreased (0.092416 --> 0.090330).  Saving model ...
Epoch: 12 cost time: 0.35651063919067383
Epoch: 12, Steps: 4 | Train Loss: 0.1755382 Vali Loss: 0.0851404
lr = 0.0003454980
Validation loss decreased (0.090330 --> 0.085140).  Saving model ...
Epoch: 13 cost time: 0.36356043815612793
Epoch: 13, Steps: 4 | Train Loss: 0.1713683 Vali Loss: 0.0839475
lr = 0.0002730120
Validation loss decreased (0.085140 --> 0.083947).  Saving model ...
Epoch: 14 cost time: 0.3552069664001465
Epoch: 14, Steps: 4 | Train Loss: 0.1703505 Vali Loss: 0.0839617
lr = 0.0002061153
EarlyStopping counter: 1 out of 5
Epoch: 15 cost time: 0.34799861907958984
Epoch: 15, Steps: 4 | Train Loss: 0.1673334 Vali Loss: 0.0848064
lr = 0.0001464551
EarlyStopping counter: 2 out of 5
Epoch: 16 cost time: 0.3838684558868408
Epoch: 16, Steps: 4 | Train Loss: 0.1695438 Vali Loss: 0.0852606
lr = 0.0000955005
EarlyStopping counter: 3 out of 5
Epoch: 17 cost time: 0.3518333435058594
Epoch: 17, Steps: 4 | Train Loss: 0.1674323 Vali Loss: 0.0828253
lr = 0.0000545062
Validation loss decreased (0.083947 --> 0.082825).  Saving model ...
Epoch: 18 cost time: 0.3887004852294922
Epoch: 18, Steps: 4 | Train Loss: 0.1644006 Vali Loss: 0.0811525
lr = 0.0000244815
Validation loss decreased (0.082825 --> 0.081153).  Saving model ...
Epoch: 19 cost time: 0.36835145950317383
Epoch: 19, Steps: 4 | Train Loss: 0.1727450 Vali Loss: 0.0807035
lr = 0.0000061658
Validation loss decreased (0.081153 --> 0.080704).  Saving model ...
Epoch: 20 cost time: 0.3659956455230713
Epoch: 20, Steps: 4 | Train Loss: 0.1614859 Vali Loss: 0.0784895
lr = 0.0000000100
Validation loss decreased (0.080704 --> 0.078490).  Saving model ...
Epoch: 21 cost time: 0.36272454261779785
Epoch: 21, Steps: 4 | Train Loss: 0.1707784 Vali Loss: 0.0822745
lr = 0.0000061658
EarlyStopping counter: 1 out of 5
Epoch: 22 cost time: 0.3719625473022461
Epoch: 22, Steps: 4 | Train Loss: 0.1675573 Vali Loss: 0.0784256
lr = 0.0000244815
Validation loss decreased (0.078490 --> 0.078426).  Saving model ...
Epoch: 23 cost time: 0.37425851821899414
Epoch: 23, Steps: 4 | Train Loss: 0.1623834 Vali Loss: 0.0794816
lr = 0.0000545062
EarlyStopping counter: 1 out of 5
Epoch: 24 cost time: 0.39994096755981445
Epoch: 24, Steps: 4 | Train Loss: 0.1663264 Vali Loss: 0.0813913
lr = 0.0000955005
EarlyStopping counter: 2 out of 5
Epoch: 25 cost time: 0.35204458236694336
Epoch: 25, Steps: 4 | Train Loss: 0.1667362 Vali Loss: 0.0833646
lr = 0.0001464551
EarlyStopping counter: 3 out of 5
Epoch: 26 cost time: 0.3899812698364258
Epoch: 26, Steps: 4 | Train Loss: 0.1649041 Vali Loss: 0.0840891
lr = 0.0002061153
EarlyStopping counter: 4 out of 5
Epoch: 27 cost time: 0.3645658493041992
Epoch: 27, Steps: 4 | Train Loss: 0.1655350 Vali Loss: 0.0762906
lr = 0.0002730120
Validation loss decreased (0.078426 --> 0.076291).  Saving model ...
Epoch: 28 cost time: 0.3597249984741211
Epoch: 28, Steps: 4 | Train Loss: 0.1606498 Vali Loss: 0.0754702
lr = 0.0003454980
Validation loss decreased (0.076291 --> 0.075470).  Saving model ...
Epoch: 29 cost time: 0.36388349533081055
Epoch: 29, Steps: 4 | Train Loss: 0.1573784 Vali Loss: 0.0765105
lr = 0.0004217885
EarlyStopping counter: 1 out of 5
Epoch: 30 cost time: 0.36475062370300293
Epoch: 30, Steps: 4 | Train Loss: 0.1617288 Vali Loss: 0.0773694
lr = 0.0005000050
EarlyStopping counter: 2 out of 5
Epoch: 31 cost time: 0.34641194343566895
Epoch: 31, Steps: 4 | Train Loss: 0.1533930 Vali Loss: 0.0835104
lr = 0.0005782215
EarlyStopping counter: 3 out of 5
Epoch: 32 cost time: 0.34195542335510254
Epoch: 32, Steps: 4 | Train Loss: 0.1630364 Vali Loss: 0.0779802
lr = 0.0006545120
EarlyStopping counter: 4 out of 5
Epoch: 33 cost time: 0.35471153259277344
Epoch: 33, Steps: 4 | Train Loss: 0.1484595 Vali Loss: 0.0761122
lr = 0.0007269980
EarlyStopping counter: 5 out of 5
Early stopping
------------------------------------
Average MAE: 0.89208984375
Average MSE: 1.0126953125
test on the ILI dataset: mse:1.0126953125 mae:0.89208984375
mse_mean = 1.0127, mse_std = 0.0000
mae_mean = 0.8921, mae_std = 0.0000
logs/TEMPO/loar_revin_100_percent_1_prompt_equal_1/ettm2_pmt1_no_pool_TEMPO_3/test_104_60_lr0.001.log
Namespace(model_id='illness_TEMPO_3_prompt_learn_104_60_100', checkpoints='./lora_revin_6domain_checkpoints_1/', task_name='long_term_forecast', prompt=1, num_nodes=1, seq_len=104, pred_len=60, label_len=18, decay_fac=0.5, learning_rate=0.001, batch_size=256, num_workers=0, train_epochs=100, lradj='type3', patience=5, gpt_layers=3, is_gpt=1, e_layers=3, d_model=768, n_heads=4, d_ff=768, dropout=0.3, enc_in=1, c_out=1, patch_size=16, kernel_size=25, loss_func='mse', pretrain=1, freeze=1, model='TEMPO', stride=8, max_len=-1, hid_dim=16, tmax=20, itr=1, cos=1, equal=1, pool=False, no_stl_loss=False, stl_weight=0.001, config_path='./configs/multiple_datasets.yml', datasets='ILI', target_data='ILI', use_token=0, electri_multiplier=1, traffic_multiplier=1, embed='timeF', percent_aug=-100, aug='ili-clo-0_256_gen_100repeat.npy', aug_only=0)
['ILI']
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (513) from 513
513 new ds
256 182
decomposing time-series...
done!
train 1026
Data aug...
0 182
val 38
ILI
dataset:  custom
Data aug...
7 aug DS found.
Shape should be: (70000, 256)
(70000, 256) aug data
sample -100 % (513) from 513
513 new ds
256 182
decomposing time-series...
done!
train 1026
Data aug...
0 182
test 134
trainable params: 154368 || all params: 60796416 || trainable%: 0.25
Epoch: 1 cost time: 0.7374556064605713
Epoch: 1, Steps: 4 | Train Loss: 1.3138332 Vali Loss: 0.6317351
lr = 0.0009938442
Validation loss decreased (inf --> 0.631735).  Saving model ...
Epoch: 2 cost time: 0.3882334232330322
Epoch: 2, Steps: 4 | Train Loss: 0.6518138 Vali Loss: 0.3453328
lr = 0.0009755285
Validation loss decreased (0.631735 --> 0.345333).  Saving model ...
Epoch: 3 cost time: 0.37929344177246094
Epoch: 3, Steps: 4 | Train Loss: 0.4628869 Vali Loss: 0.2173423
lr = 0.0009455038
Validation loss decreased (0.345333 --> 0.217342).  Saving model ...
Epoch: 4 cost time: 0.34858059883117676
Epoch: 4, Steps: 4 | Train Loss: 0.3795685 Vali Loss: 0.1651589
lr = 0.0009045095
Validation loss decreased (0.217342 --> 0.165159).  Saving model ...
Epoch: 5 cost time: 0.3587164878845215
Epoch: 5, Steps: 4 | Train Loss: 0.2967302 Vali Loss: 0.1226481
lr = 0.0008535549
Validation loss decreased (0.165159 --> 0.122648).  Saving model ...
Epoch: 6 cost time: 0.3529224395751953
Epoch: 6, Steps: 4 | Train Loss: 0.2585003 Vali Loss: 0.1040706
lr = 0.0007938947
Validation loss decreased (0.122648 --> 0.104071).  Saving model ...
Epoch: 7 cost time: 0.3533666133880615
Epoch: 7, Steps: 4 | Train Loss: 0.2322113 Vali Loss: 0.1042045
lr = 0.0007269980
EarlyStopping counter: 1 out of 5
Epoch: 8 cost time: 0.3645021915435791
Epoch: 8, Steps: 4 | Train Loss: 0.2203665 Vali Loss: 0.0994355
lr = 0.0006545120
Validation loss decreased (0.104071 --> 0.099435).  Saving model ...
Epoch: 9 cost time: 0.37093448638916016
Epoch: 9, Steps: 4 | Train Loss: 0.2098859 Vali Loss: 0.0922606
lr = 0.0005782215
Validation loss decreased (0.099435 --> 0.092261).  Saving model ...
Epoch: 10 cost time: 0.3536860942840576
Epoch: 10, Steps: 4 | Train Loss: 0.1933699 Vali Loss: 0.0871631
lr = 0.0005000050
Validation loss decreased (0.092261 --> 0.087163).  Saving model ...
Epoch: 11 cost time: 0.34894537925720215
Epoch: 11, Steps: 4 | Train Loss: 0.1924141 Vali Loss: 0.0825101
lr = 0.0004217885
Validation loss decreased (0.087163 --> 0.082510).  Saving model ...
Epoch: 12 cost time: 0.37261366844177246
Epoch: 12, Steps: 4 | Train Loss: 0.1893771 Vali Loss: 0.0831909
lr = 0.0003454980
EarlyStopping counter: 1 out of 5
Epoch: 13 cost time: 0.3900582790374756
Epoch: 13, Steps: 4 | Train Loss: 0.1839058 Vali Loss: 0.0796172
lr = 0.0002730120
Validation loss decreased (0.082510 --> 0.079617).  Saving model ...
Epoch: 14 cost time: 0.36658501625061035
Epoch: 14, Steps: 4 | Train Loss: 0.1804140 Vali Loss: 0.0825028
lr = 0.0002061153
EarlyStopping counter: 1 out of 5
Epoch: 15 cost time: 0.3898031711578369
Epoch: 15, Steps: 4 | Train Loss: 0.1836125 Vali Loss: 0.0818000
lr = 0.0001464551
EarlyStopping counter: 2 out of 5
Epoch: 16 cost time: 0.37415003776550293
Epoch: 16, Steps: 4 | Train Loss: 0.1688623 Vali Loss: 0.0785814
lr = 0.0000955005
Validation loss decreased (0.079617 --> 0.078581).  Saving model ...
Epoch: 17 cost time: 0.345703125
Epoch: 17, Steps: 4 | Train Loss: 0.1664359 Vali Loss: 0.0828073
lr = 0.0000545062
EarlyStopping counter: 1 out of 5
Epoch: 18 cost time: 0.3343038558959961
Epoch: 18, Steps: 4 | Train Loss: 0.1760433 Vali Loss: 0.0792166
lr = 0.0000244815
EarlyStopping counter: 2 out of 5
Epoch: 19 cost time: 0.34295058250427246
Epoch: 19, Steps: 4 | Train Loss: 0.1772642 Vali Loss: 0.0815281
lr = 0.0000061658
EarlyStopping counter: 3 out of 5
Epoch: 20 cost time: 0.36391711235046387
Epoch: 20, Steps: 4 | Train Loss: 0.1715151 Vali Loss: 0.0839837
lr = 0.0000000100
EarlyStopping counter: 4 out of 5
Epoch: 21 cost time: 0.3784048557281494
Epoch: 21, Steps: 4 | Train Loss: 0.1647826 Vali Loss: 0.0793318
lr = 0.0000061658
EarlyStopping counter: 5 out of 5
Early stopping
------------------------------------
Average MAE: 0.98095703125
Average MSE: 1.201171875
test on the ILI dataset: mse:1.201171875 mae:0.98095703125
mse_mean = 1.2012, mse_std = 0.0000
mae_mean = 0.9810, mae_std = 0.0000
